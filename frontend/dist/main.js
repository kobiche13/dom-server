(()=>{"use strict";function t(e){return t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},t(e)}function e(t,e){for(var i=0;i<e.length;i++){var r=e[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,n(r.key),r)}}function n(e){var n=function(e,n){if("object"!=t(e)||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,n||"default");if("object"!=t(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===n?String:Number)(e)}(e,"string");return"symbol"==t(n)?n:n+""}var i=function(){return t=function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)},(n=[{key:"createTicketForm",value:function(t,e){var n=document.createElement("div");n.className=t,document.querySelector(e).appendChild(n)}},{key:"createTicketElement",value:function(t,e){var n=document.createElement(t);n.className=e,this.elementHTML=n}},{key:"createTicket",value:function(){var t=this;Array.from(document.querySelectorAll(".ticket-container")).forEach((function(e){t.createTicketElement("div","ticket-container__status"),e.append(t.elementHTML),t.createTicketElement("div","ticket-container__name"),e.append(t.elementHTML),t.createTicketElement("div","ticket-container__description"),e.lastElementChild.append(t.elementHTML),t.createTicketElement("div","ticket-container__date"),e.append(t.elementHTML),t.createTicketElement("div","ticket-container__change"),e.append(t.elementHTML),t.createTicketElement("div","ticket-container__delete"),e.append(t.elementHTML)}))}},{key:"fillingTicketStatus",value:function(t){Array.from(document.querySelectorAll(".ticket-container__status")).forEach((function(e,n){1==t[n].status&&e.classList.add("true")}))}},{key:"fillingTicketName",value:function(t){Array.from(document.querySelectorAll(".ticket-container__name")).forEach((function(e,n){var i=document.createElement("p");i.className="ticket-container__description-text",i.textContent=t[n].name,e.prepend(i)}))}},{key:"fillingTicketDate",value:function(t){Array.from(document.querySelectorAll(".ticket-container__date")).forEach((function(e,n){var i=new Date(t[n].created);e.textContent=i.toLocaleString()}))}},{key:"fillingTicketEvent",value:function(t){"click"==t.type&&t.target.classList.contains("ticket-container__description-text")&&""!==t.target.nextElementSibling.textContent&&("block"!==t.target.nextElementSibling.style.display?t.target.nextElementSibling.style.display="block":t.target.nextElementSibling.style.display="none")}},{key:"fillingTicketDescription",value:function(t){Array.from(document.querySelectorAll(".ticket-container__description")).forEach((function(e,n){" "!==t[n].description&&(e.textContent=t[n].description)}))}}])&&e(t.prototype,n),i&&e(t,i),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,n,i}(),r=["description","status","created"],o=["description","created"];function c(t){return c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},c(t)}function a(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,i)}return n}function l(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?a(Object(n),!0).forEach((function(e){s(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):a(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function s(t,e,n){return(e=d(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function u(t,e){if(null==t)return{};var n,i,r=function(t,e){if(null==t)return{};var n={};for(var i in t)if({}.hasOwnProperty.call(t,i)){if(-1!==e.indexOf(i))continue;n[i]=t[i]}return n}(t,e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);for(i=0;i<o.length;i++)n=o[i],-1===e.indexOf(n)&&{}.propertyIsEnumerable.call(t,n)&&(r[n]=t[n])}return r}function f(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,d(i.key),i)}}function d(t){var e=function(t,e){if("object"!=c(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var i=n.call(t,e||"default");if("object"!=c(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==c(e)?e:e+""}var y=void 0,p=void 0,m=function(){return t=function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.data=void 0},e=[{key:"loadTicket",value:function(){var t=new XMLHttpRequest;self=this,window.addEventListener("load",(function(e){e.preventDefault(),t.open("GET","http://localhost:7070?method=allTickets"),t.send(),t.onreadystatechange=function(){4===t.readyState&&(this.data=JSON.parse(t.responseText),self.addTickets(this.data),self.saveIdTickets(this.data),self.saveStatusTickets(this.data))}}))}},{key:"addTickets",value:function(t){for(var e=new i,n=0;n<t.length;n++)e.createTicketForm("ticket-container",".tickets-form");e.createTicket(),e.fillingTicketDate(t),e.fillingTicketStatus(t),e.fillingTicketName(t),e.fillingTicketDescription(t),document.body.addEventListener("click",e.fillingTicketEvent.bind(this),!0)}},{key:"saveIdTickets",value:function(t){y=t.map((function(t){return t.description,t.status,t.created,l({},u(t,r))}))}},{key:"saveStatusTickets",value:function(t){p=t.map((function(t){return t.description,t.created,l({},u(t,o))})),console.log(p);var e=Array.from(document.querySelectorAll(".ticket-container"));console.log(e),p.forEach((function(t,n){0==t.status?e[n].children[0].classList.remove("true"):e[n].children[0].classList.add("true")}))}}],e&&f(t.prototype,e),n&&f(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,n}();function v(t){return v="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},v(t)}function k(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,b(i.key),i)}}function b(t){var e=function(t,e){if("object"!=v(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var i=n.call(t,e||"default");if("object"!=v(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==v(e)?e:e+""}var h=function(){return t=function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.btnAdd=document.querySelector(".button-add"),this.form=document.querySelector(".form-field")},(e=[{key:"newTicket",value:function(){document.body.addEventListener("click",this.clickAddTicket.bind(this)),document.body.addEventListener("click",this.pushTicketInServer.bind(this))}},{key:"clickAddTicket",value:function(t){this.containerForm=document.querySelector(".container-form"),"click"==t.type&&(t.target.classList.contains("button-add")?this.containerForm.style.display="block":(t.target.classList.contains("button-close")||t.target.classList.contains("button-ok"))&&(this.containerForm.style.display="none"))}},{key:"pushTicketInServer",value:function(t){if(t.target.classList.contains("button-ok")){var e={};new FormData(this.form).forEach((function(t,n){e[n]=t}));var n=JSON.stringify(e),i=new XMLHttpRequest;i.onreadystatechange=function(){i.readyState},i.open("POST","http://localhost:7070?method=createTicket"),i.send(n)}}}])&&k(t.prototype,e),n&&k(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,n}();function T(t){return T="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},T(t)}function g(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,S(i.key),i)}}function S(t){var e=function(t,e){if("object"!=T(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var i=n.call(t,e||"default");if("object"!=T(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==T(e)?e:e+""}var w=function(){return t=function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.searchName=void 0,this.positionTicket=void 0,this.idDeleteTicket=void 0},(e=[{key:"deleteTicket",value:function(){document.body.addEventListener("click",this.clickDeleteTicket.bind(this)),document.body.addEventListener("click",this.deleteTicketInServer.bind(this))}},{key:"clickDeleteTicket",value:function(t){this.containerDelete=document.querySelector(".delete-tickets__container"),"click"==t.type&&(t.target.classList.contains("ticket-container__delete")?(this.searchName=t.target.closest(".ticket-container"),this.containerDelete.style.display="block"):(t.target.classList.contains("close-delete")||t.target.classList.contains("ok-delete"))&&(this.containerDelete.style.display="none"))}},{key:"deleteTicketInServer",value:function(t){if(t.target.classList.contains("ok-delete")){self=this,self.searchIdTicket();var e=new XMLHttpRequest;e.open("GET","http://localhost:7070?method=deleteById&id="+"".concat(y[this.idDeleteTicket].id)),e.send(),e.onreadystatechange=function(){4===e.readyState&&location.reload()}}}},{key:"searchIdTicket",value:function(){var t=this,e=this.searchName.querySelector(".ticket-container__description-text").textContent;y.forEach((function(n,i){n.name==e&&(t.idDeleteTicket=i)}))}}])&&g(t.prototype,e),n&&g(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,n}();function E(t){return E="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},E(t)}function _(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,O(i.key),i)}}function O(t){var e=function(t,e){if("object"!=E(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var i=n.call(t,e||"default");if("object"!=E(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==E(e)?e:e+""}var L=function(){return t=function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.form=document.querySelector(".form-field__update"),this.containerForm=document.querySelector(".container-form__update"),this.searchTicketContainer=void 0,this.idUpdateTicket=void 0,this.statusTicket=void 0,this.statusForUpdate=void 0},(e=[{key:"ticketUpdate",value:function(){document.body.addEventListener("click",this.clickCompletedTicket.bind(this)),document.body.addEventListener("click",this.clickEditTicket.bind(this)),document.body.addEventListener("click",this.pushUpdateTicketInServer.bind(this))}},{key:"clickCompletedTicket",value:function(t){t.target.classList.contains("ticket-container__status")&&(t.target.classList.contains("true")?t.target.classList.remove("true"):t.target.classList.add("true"))}},{key:"clickEditTicket",value:function(t){if("click"==t.type)if(t.target.classList.contains("ticket-container__change")){this.containerForm.style.display="block";var e=this.form.querySelector(".form-field-update__text"),n=this.form.querySelector(".textarea-update-description");this.searchTicketContainer=t.target.closest(".ticket-container"),e.value=this.searchTicketContainer.querySelector(".ticket-container__description-text").textContent,n.value=this.searchTicketContainer.querySelector(".ticket-container__description").textContent}else(t.target.classList.contains("button-update-close")||t.target.classList.contains("button-update-ok"))&&(this.containerForm.style.display="none")}},{key:"pushUpdateTicketInServer",value:function(t){var e=this;if(t.target.classList.contains("button-update-ok")){var n={};new FormData(this.form).forEach((function(t,e){n[e]=t})),self=this,self.searchIdUpdateTicket(),n.status=this.statusForUpdate;var i=JSON.stringify(n),r=new XMLHttpRequest;r.onreadystatechange=function(){4===r.readyState&&location.reload()},r.open("POST","http://localhost:7070?method=updateById&id="+"".concat(p[this.idUpdateTicket].id)),r.send(i)}else if(t.target.classList.contains("ticket-container__status")){var o=t.target.closest(".ticket-container"),c=o.querySelector(".ticket-container__description-text").textContent;p.forEach((function(t,n){t.name==c&&(e.idUpdateTicket=n,null!==o.querySelector(".true")?e.statusForUpdate=!0:e.statusForUpdate=!1)}));var a={};self=this,a.status=this.statusForUpdate;var l=JSON.stringify(a),s=new XMLHttpRequest;s.onreadystatechange=function(){4===s.readyState&&location.reload()},s.open("POST","http://localhost:7070?method=updateById&id="+"".concat(p[this.idUpdateTicket].id)),s.send(l)}}},{key:"searchIdUpdateTicket",value:function(){var t=this,e=this.searchTicketContainer.querySelector(".ticket-container__description-text").textContent;p.forEach((function(n,i){n.name==e&&(t.idUpdateTicket=i,null!==t.searchTicketContainer.querySelector(".true")?t.statusForUpdate=!0:t.statusForUpdate=!1)}))}},{key:"changeStatusIfPage",value:function(){}}])&&_(t.prototype,e),n&&_(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,n}();function P(t){return P="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},P(t)}function j(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,q(i.key),i)}}function q(t){var e=function(t,e){if("object"!=P(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var i=n.call(t,e||"default");if("object"!=P(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==P(e)?e:e+""}(new(function(){return t=function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)},(e=[{key:"initApp",value:function(){this.loadAllTickets=new m,this.newTickets=new h,this.deleteTicket=new w,this.updateTicket=new L,this.deleteTicket.deleteTicket(),this.loadAllTickets.loadTicket(),this.newTickets.newTicket(),this.updateTicket.ticketUpdate()}}])&&j(t.prototype,e),n&&j(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,n}())).initApp()})();